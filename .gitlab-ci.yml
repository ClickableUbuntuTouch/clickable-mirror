stages:
  - test
  - publish

integration-test:
  stage: test
  image: clickable/testing
  script:
    - nosetests integration

unit-test:
  stage: test
  image: clickable/testing
  script:
    - nosetests unit

check-template-names:
  stage: test
  image: clickable/testing
  script:
    - tests/check-template-names.py
  allow_failure: true

lint:
  stage: test
  image: clickable/clickable-ci
  script:
    - flake8
    - pylint clickable

publish-pypi:
  stage: publish
  image: clickable/clickable-ci
  only:
    - tags
  script:
    - python3 setup.py sdist bdist_wheel
    - python3 -m twine upload dist/*
